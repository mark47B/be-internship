# Load Test для PR Reviewer Service

## Что тестируют сценарии


####  Полный жизненный цикл команды и Pull Request’а:

1. Создание команды (3 участника) → 201
2. Попытка создать дубликат команды → ожидаем 400
3. Получение команды → 200
4. Создание PR → 200
5. Попытка создать дубликат PR → ожидаем 409
6. Reassign PR (статус OPEN) → 200
7. Merge PR → 200
8. Reassign уже замерженного PR → ожидаем 409
9. Массовая деактивация участников команды → 200

Каждая итерация создаёт полностью уникальные team и PR — никаких дублей и ложных 400/409.

#### Тест массовой деактивации
Создаётся полноценная нагрузочная «подложка»:
20 команд
200 пользователей (по 10 в каждой команде)
40 Pull Request’ов (по 2 на команду)

Массовая деактивация первых 4 пользователей в первой команде


## Как запустить

Из корня репозитория:
```bash
	docker compose -f docker-compose.jmeter.yml up --build
```
### После запуска смотрите:
- `reports/results.csv` — сырые данные
- `reports/jmeter.log` — логи

## Результаты

### Подготовленные заранее результаты:

1. Тест эндпойнта массовой деактивации

| Параметр            | Использованное значение |
|---------------------|-----------------------|
| Количество потоков  | 5                     |
| Ramp-up             | 10 сек                |
| Целевые RPS         | 5                     |
| Кол-во итераций     | 10 на поток          |

- `reports/deactivate-massive/results.csv` — сырые данные
- `reports/deactivate-massive/jmeter.log` — логи (включая сгенерированные имена команд и PR)

Результат: значение превышает заданные ограничения в 12 раз :(

2. Нагрузочный тест под параметры задания

| Параметр            | Использованное значение |
|---------------------|-----------------------|
| Количество потоков  | 5                     |
| Ramp-up             | 10 сек                |
| Целевые RPS         | 5                     |
| Кол-во итераций     | 5                     |

- `reports/overall-test/results.csv` — сырые данные
- `reports/overall-test/jmeter.log` — логи (включая сгенерированные имена команд и PR)

Результат: Количество ошибок: 0 (0.00 %) — все запросы отработали успешно
Общее количество выполненных сэмплов (запросов): 1507
Average response time: 4 мс
90-я перцентиль: ≤ 10–12 мс
99-я перцентиль: значительно ниже 603 мс (единичный стартовый пик)


## Особенности реализации

- Уникальные идентификаторы генерируются на каждой итерации (Counter + JSR223 Sampler)
- Все ожидаемые «ошибки» (400, 409) помечены `assume_success=true` → не портят статистику
- Файл валиден для JMeter 5.5 – 5.6.3
